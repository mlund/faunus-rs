# Places two rigid molecules on a spherical cell and tracks
# the mass center separation during a MC simulation run. This
# can be used to calculate the potential of mean force.
#
# - The first molecule is placed at the center of a sphere and
#   can rotate only.
# - The second molecule is offset along the z-axis. It can
#   translate along z only, and freely rotate.
# - The `medium` information is used to set a Debye screening length
#   for the `Coulomb` potential under `nonbonded`.
# - The simulation cell is a sphere with hard boundaries from which no
#   particles can escape.

atoms:
  - name: MP # middle particle
    mass: 1
    charge: 0.0
    sigma: 4.0
    epsilon: 0.5
    hydrophobicity: !Lambda 0.7
  - name: cation
    mass: 1
    charge: 2.0
    sigma: 3.0
    epsilon: 0.4
    hydrophobicity: !Lambda 0.6
  - name: anion
    mass: 1
    charge: -2.0
    sigma: 2.0
    epsilon: 0.3
    hydrophobicity: !Lambda 0.5

molecules:
  - name: MOL1
    degrees_of_freedom: Rigid
    has_com: true
    from_structure: "stick.xyz" 
  - name: MOL2
    degrees_of_freedom: Rigid
    has_com: true
    from_structure: "stick.xyz" 

system:
  cell: !Sphere { radius: 60.0 }
  medium:
    permittivity: !Water
    temperature: 298.15
    # salt type and concentration in mol/l
    salt: [!NaCl, 0.01]

  blocks:
    - molecule: MOL1
      N: 1
      insert:
        # Place in the middle of the box
        !RandomCOM {
          filename: "stick.xyz",
          rotate: true,
          directions: none,
          offset: [0.0, 0.0, 0.0],
        }
    - molecule: MOL2
      N: 1
      insert:
        # Place along z-axis
        !RandomCOM {
          filename: "stick.xyz",
          rotate: true,
          directions: none,
          offset: [0.0, 0.0, 42.0],
        }

  energy:
    nonbonded:
      default:
        - !Coulomb {cutoff: 1000}
        - !AshbaughHatch {mixing: arithmetic, cutoff: 20.0}
        # !WeeksChandlerAndersen {mixing: LB}

analysis:
  - !MassCenterDistance
    molecules: ["MOL1", "MOL2"]
    file: "com_distance.dat.gz"
    frequency: !Every 10
  - !Trajectory
    file: "traj.xyz"
    frequency: !Every 100

propagate:
  seed: Hardware
  criterion: Metropolis
  repeat: 10000000
  collections:
    - !Stochastic
      moves:
        - !RotateMolecule {
            molecule: MOL1,
            dp: 1.0,
            weight: 1.0,
          }
        - !RotateMolecule {
            molecule: MOL2,
            dp: 1.0,
            weight: 1.0,
          }
        - !TranslateMolecule {
            molecule: MOL2,
            dp: 10.0,
            weight: 1.0,
            directions: !z,
          }
